<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-11-06">
<meta name="description" content="Linear and non linear regration">

<title>Yoseph’s ML Blog - Song popularity prediction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Yoseph’s ML Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../CS5805.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#dataset" id="toc-dataset" class="nav-link" data-scroll-target="#dataset">Dataset</a>
  <ul class="collapse">
  <li><a href="#description-of-dataset" id="toc-description-of-dataset" class="nav-link" data-scroll-target="#description-of-dataset">Description of dataset</a></li>
  </ul></li>
  <li><a href="#task" id="toc-task" class="nav-link" data-scroll-target="#task">Task</a></li>
  <li><a href="#load-the-data" id="toc-load-the-data" class="nav-link" data-scroll-target="#load-the-data">Load the data</a></li>
  <li><a href="#remove-identifiers" id="toc-remove-identifiers" class="nav-link" data-scroll-target="#remove-identifiers">Remove identifiers</a></li>
  <li><a href="#date-data" id="toc-date-data" class="nav-link" data-scroll-target="#date-data">Date Data</a></li>
  <li><a href="#missing-values" id="toc-missing-values" class="nav-link" data-scroll-target="#missing-values">Missing values</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization">Visualization</a></li>
  <li><a href="#one-hot-encoding" id="toc-one-hot-encoding" class="nav-link" data-scroll-target="#one-hot-encoding">One hot encoding</a>
  <ul class="collapse">
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation">Correlation</a></li>
  </ul></li>
  <li><a href="#target-and-data" id="toc-target-and-data" class="nav-link" data-scroll-target="#target-and-data">Target and Data</a></li>
  <li><a href="#normalization" id="toc-normalization" class="nav-link" data-scroll-target="#normalization">Normalization</a></li>
  <li><a href="#training-and-test-split-and-data" id="toc-training-and-test-split-and-data" class="nav-link" data-scroll-target="#training-and-test-split-and-data">Training and Test Split and Data</a></li>
  </ul></li>
  <li><a href="#training-and-optimization" id="toc-training-and-optimization" class="nav-link" data-scroll-target="#training-and-optimization">Training and Optimization</a>
  <ul class="collapse">
  <li><a href="#regression-models" id="toc-regression-models" class="nav-link" data-scroll-target="#regression-models">Regression models</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a>
  <ul class="collapse">
  <li><a href="#best-model" id="toc-best-model" class="nav-link" data-scroll-target="#best-model">Best Model</a></li>
  <li><a href="#other-sample-runs-are-as-follows" id="toc-other-sample-runs-are-as-follows" class="nav-link" data-scroll-target="#other-sample-runs-are-as-follows">Other sample runs are as follows</a>
  <ul class="collapse">
  <li><a href="#kneighborsregressor" id="toc-kneighborsregressor" class="nav-link" data-scroll-target="#kneighborsregressor">KNeighborsRegressor</a></li>
  <li><a href="#radiusneighborsregressor" id="toc-radiusneighborsregressor" class="nav-link" data-scroll-target="#radiusneighborsregressor">RadiusNeighborsRegressor</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/yosephberhanu/ml-blog/blob/main/posts/regression.qmd" class="toc-action">View source</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Song popularity prediction</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Regression</div>
  </div>
  </div>

<div>
  <div class="description">
    Linear and non linear regration
  </div>
</div>


<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 6, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction" class="level1">
<h1>Introduction</h1>
<section id="dataset" class="level2">
<h2 class="anchored" data-anchor-id="dataset">Dataset</h2>
<p>In this blog post I’ll try to explore linear and nonlinear regression ML algorithms to predict popularity of a song based on a data set of almost 30,000 songs from Spotify API collected using the <a href="https://www.rcharlie.com/spotifyr/"><code>spotifyr</code> package</a>. The package and orgnial data set can be found <a href="https://www.kaggle.com/datasets/joebeachcapital/30000-spotify-songs/">here</a>.</p>
<section id="description-of-dataset" class="level3">
<h3 class="anchored" data-anchor-id="description-of-dataset">Description of dataset</h3>
<p>This dataset encompasses various attributes providing diverse information about songs, artists, popularity, musical features, and playlist characteristics, making it suitable for music-related analyses or applications in data analysis and machine learning.</p>
<ul>
<li><strong>Track_id</strong>: Unique ID for a song</li>
<li><strong>Track_name</strong>: Name of the song</li>
<li><strong>Track_artist</strong>: Artist of the song</li>
<li><strong>Track_popularity</strong>: Song popularity rating (0-100)</li>
<li><strong>Track_album_id</strong>: Unique ID for the album</li>
<li><strong>Track_album_name</strong>: Name of the album</li>
<li><strong>Track_album_release_date</strong>: Release date of the album</li>
<li><strong>Playlist_name</strong>: Name of the playlist</li>
<li><strong>Playlist_id</strong>: ID of the playlist</li>
<li><strong>Playlist_genre</strong>: Genre of the playlist</li>
<li><strong>Playlist_subgenre</strong>: Subgenre of the playlist</li>
<li><strong>Danceability</strong>: Describes how suitable a track is for dancing (0.0 to 1.0)</li>
<li><strong>Energy</strong>: Represents intensity and activity of the track (0.0 to 1.0)</li>
<li><strong>Key</strong>: Estimated overall key of the track</li>
<li><strong>Loudness</strong>: Overall loudness of a track in decibels (dB)</li>
<li><strong>Mode</strong>: Indicates the modality (major or minor) of a track (0 for minor, 1 for major)</li>
<li><strong>Speechiness</strong>: Detects the presence of spoken words in a track (0.0 to 1.0)</li>
<li><strong>Acousticness</strong>: Confidence measure of whether the track is acoustic (0.0 to 1.0)</li>
<li><strong>Instrumentalness</strong>: Predicts whether a track contains no vocals (0.0 to 1.0)</li>
<li><strong>Liveness</strong>: Detects the presence of an audience in the recording</li>
<li><strong>Valence</strong>: Describes the musical positiveness conveyed by a track (0.0 to 1.0)</li>
<li><strong>Tempo</strong>: Estimated tempo of a track in beats per minute (BPM)</li>
<li><strong>Duration_ms</strong>: Duration of the song in milliseconds</li>
</ul>
</section>
</section>
<section id="task" class="level2">
<h2 class="anchored" data-anchor-id="task">Task</h2>
<p>The task for this blog post is to train a couple of regression models and predict how pouplar a song is given the other features about the song.<br>
# Preprocessing ## Imports</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RandomizedSearchCV</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> (</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    AdaBoostRegressor,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    RandomForestRegressor,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    GradientBoostingRegressor,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    BaggingRegressor,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    ExtraTreesRegressor,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsRegressor</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> RadiusNeighborsRegressor</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> svm</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-the-data" class="level2">
<h2 class="anchored" data-anchor-id="load-the-data">Load the data</h2>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>songs <span class="op">=</span> pd.read_csv(<span class="st">"../data/spotify_songs.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>songs.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">track_id</th>
<th data-quarto-table-cell-role="th">track_name</th>
<th data-quarto-table-cell-role="th">track_artist</th>
<th data-quarto-table-cell-role="th">track_popularity</th>
<th data-quarto-table-cell-role="th">track_album_id</th>
<th data-quarto-table-cell-role="th">track_album_name</th>
<th data-quarto-table-cell-role="th">track_album_release_date</th>
<th data-quarto-table-cell-role="th">playlist_name</th>
<th data-quarto-table-cell-role="th">playlist_id</th>
<th data-quarto-table-cell-role="th">playlist_genre</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">loudness</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">speechiness</th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">instrumentalness</th>
<th data-quarto-table-cell-role="th">liveness</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">tempo</th>
<th data-quarto-table-cell-role="th">duration_ms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>6f807x0ima9a1j3VPbc7VN</td>
<td>I Don't Care (with Justin Bieber) - Loud Luxur...</td>
<td>Ed Sheeran</td>
<td>66</td>
<td>2oCs0DGTsRO98Gh5ZSl2Cx</td>
<td>I Don't Care (with Justin Bieber) [Loud Luxury...</td>
<td>2019-06-14</td>
<td>Pop Remix</td>
<td>37i9dQZF1DXcZDD7cfEKhW</td>
<td>pop</td>
<td>...</td>
<td>6</td>
<td>-2.634</td>
<td>1</td>
<td>0.0583</td>
<td>0.1020</td>
<td>0.000000</td>
<td>0.0653</td>
<td>0.518</td>
<td>122.036</td>
<td>194754</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0r7CVbZTWZgbTCYdfa2P31</td>
<td>Memories - Dillon Francis Remix</td>
<td>Maroon 5</td>
<td>67</td>
<td>63rPSO264uRjW1X5E6cWv6</td>
<td>Memories (Dillon Francis Remix)</td>
<td>2019-12-13</td>
<td>Pop Remix</td>
<td>37i9dQZF1DXcZDD7cfEKhW</td>
<td>pop</td>
<td>...</td>
<td>11</td>
<td>-4.969</td>
<td>1</td>
<td>0.0373</td>
<td>0.0724</td>
<td>0.004210</td>
<td>0.3570</td>
<td>0.693</td>
<td>99.972</td>
<td>162600</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1z1Hg7Vb0AhHDiEmnDE79l</td>
<td>All the Time - Don Diablo Remix</td>
<td>Zara Larsson</td>
<td>70</td>
<td>1HoSmj2eLcsrR0vE9gThr4</td>
<td>All the Time (Don Diablo Remix)</td>
<td>2019-07-05</td>
<td>Pop Remix</td>
<td>37i9dQZF1DXcZDD7cfEKhW</td>
<td>pop</td>
<td>...</td>
<td>1</td>
<td>-3.432</td>
<td>0</td>
<td>0.0742</td>
<td>0.0794</td>
<td>0.000023</td>
<td>0.1100</td>
<td>0.613</td>
<td>124.008</td>
<td>176616</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>75FpbthrwQmzHlBJLuGdC7</td>
<td>Call You Mine - Keanu Silva Remix</td>
<td>The Chainsmokers</td>
<td>60</td>
<td>1nqYsOef1yKKuGOVchbsk6</td>
<td>Call You Mine - The Remixes</td>
<td>2019-07-19</td>
<td>Pop Remix</td>
<td>37i9dQZF1DXcZDD7cfEKhW</td>
<td>pop</td>
<td>...</td>
<td>7</td>
<td>-3.778</td>
<td>1</td>
<td>0.1020</td>
<td>0.0287</td>
<td>0.000009</td>
<td>0.2040</td>
<td>0.277</td>
<td>121.956</td>
<td>169093</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1e8PAfcKUYoKkxPhrHqw4x</td>
<td>Someone You Loved - Future Humans Remix</td>
<td>Lewis Capaldi</td>
<td>69</td>
<td>7m7vv9wlQ4i0LFuJiE2zsQ</td>
<td>Someone You Loved (Future Humans Remix)</td>
<td>2019-03-05</td>
<td>Pop Remix</td>
<td>37i9dQZF1DXcZDD7cfEKhW</td>
<td>pop</td>
<td>...</td>
<td>1</td>
<td>-4.672</td>
<td>1</td>
<td>0.0359</td>
<td>0.0803</td>
<td>0.000000</td>
<td>0.0833</td>
<td>0.725</td>
<td>123.976</td>
<td>189052</td>
</tr>
</tbody>
</table>

<p>5 rows × 23 columns</p>
</div>
</div>
</div>
</section>
<section id="remove-identifiers" class="level2">
<h2 class="anchored" data-anchor-id="remove-identifiers">Remove identifiers</h2>
<p>Features like track_id, track_name, track_artist, track_album_id, track_album_name, playlist_id,playlist_name will have little contribution to our model as they are unique identifiers. Hence we’ll remove them from the data.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>songs <span class="op">=</span> songs.drop(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"track_id"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"track_name"</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"track_artist"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"track_album_id"</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"track_album_name"</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"playlist_id"</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"playlist_name"</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    axis<span class="op">=</span><span class="st">"columns"</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>songs.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">track_popularity</th>
<th data-quarto-table-cell-role="th">track_album_release_date</th>
<th data-quarto-table-cell-role="th">playlist_genre</th>
<th data-quarto-table-cell-role="th">playlist_subgenre</th>
<th data-quarto-table-cell-role="th">danceability</th>
<th data-quarto-table-cell-role="th">energy</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">loudness</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">speechiness</th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">instrumentalness</th>
<th data-quarto-table-cell-role="th">liveness</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">tempo</th>
<th data-quarto-table-cell-role="th">duration_ms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>66</td>
<td>2019-06-14</td>
<td>pop</td>
<td>dance pop</td>
<td>0.748</td>
<td>0.916</td>
<td>6</td>
<td>-2.634</td>
<td>1</td>
<td>0.0583</td>
<td>0.1020</td>
<td>0.000000</td>
<td>0.0653</td>
<td>0.518</td>
<td>122.036</td>
<td>194754</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>67</td>
<td>2019-12-13</td>
<td>pop</td>
<td>dance pop</td>
<td>0.726</td>
<td>0.815</td>
<td>11</td>
<td>-4.969</td>
<td>1</td>
<td>0.0373</td>
<td>0.0724</td>
<td>0.004210</td>
<td>0.3570</td>
<td>0.693</td>
<td>99.972</td>
<td>162600</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>70</td>
<td>2019-07-05</td>
<td>pop</td>
<td>dance pop</td>
<td>0.675</td>
<td>0.931</td>
<td>1</td>
<td>-3.432</td>
<td>0</td>
<td>0.0742</td>
<td>0.0794</td>
<td>0.000023</td>
<td>0.1100</td>
<td>0.613</td>
<td>124.008</td>
<td>176616</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>60</td>
<td>2019-07-19</td>
<td>pop</td>
<td>dance pop</td>
<td>0.718</td>
<td>0.930</td>
<td>7</td>
<td>-3.778</td>
<td>1</td>
<td>0.1020</td>
<td>0.0287</td>
<td>0.000009</td>
<td>0.2040</td>
<td>0.277</td>
<td>121.956</td>
<td>169093</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>69</td>
<td>2019-03-05</td>
<td>pop</td>
<td>dance pop</td>
<td>0.650</td>
<td>0.833</td>
<td>1</td>
<td>-4.672</td>
<td>1</td>
<td>0.0359</td>
<td>0.0803</td>
<td>0.000000</td>
<td>0.0833</td>
<td>0.725</td>
<td>123.976</td>
<td>189052</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="date-data" class="level2">
<h2 class="anchored" data-anchor-id="date-data">Date Data</h2>
<p>To capture seasonal popularity I’ll split the date value into three columns with year, month and day values. We first convert the string representation of track_album_release_date to date datatype and takeout the individual values separately.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>songs[<span class="st">"track_album_release_date"</span>] <span class="op">=</span> pd.to_datetime(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    songs[<span class="st">"track_album_release_date"</span>], <span class="bu">format</span><span class="op">=</span><span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">"</span>, errors<span class="op">=</span><span class="st">"coerce"</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>songs[<span class="st">"release_year"</span>] <span class="op">=</span> songs[<span class="st">"track_album_release_date"</span>].dt.year</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>songs[<span class="st">"release_month"</span>] <span class="op">=</span> songs[<span class="st">"track_album_release_date"</span>].dt.month</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>songs[<span class="st">"release_day"</span>] <span class="op">=</span> songs[<span class="st">"track_album_release_date"</span>].dt.day</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>songs <span class="op">=</span> songs.drop([<span class="st">"track_album_release_date"</span>], axis<span class="op">=</span><span class="st">"columns"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="missing-values" class="level2">
<h2 class="anchored" data-anchor-id="missing-values">Missing values</h2>
<p>Let’s check if there are any missing values in our dataset</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>songs.isnull().values.<span class="bu">any</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>True</code></pre>
</div>
</div>
<p>It seems we’ve some</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>songs.isnull().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>track_popularity        0
playlist_genre          0
playlist_subgenre       0
danceability            0
energy                  0
key                     0
loudness                0
mode                    0
speechiness             0
acousticness            0
instrumentalness        0
liveness                0
valence                 0
tempo                   0
duration_ms             0
release_year         1886
release_month        1886
release_day          1886
dtype: int64</code></pre>
</div>
</div>
<p>Given the missing date values are arround 17% our data simply dropping the rows does not yeild an ideal outcome. Hence, let’s to fill the missing columns with the most common value in that feature</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>songs[<span class="st">"release_year"</span>].fillna(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    songs[<span class="st">"release_year"</span>].value_counts().index[<span class="dv">0</span>], inplace<span class="op">=</span><span class="va">True</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>songs[<span class="st">"release_month"</span>].fillna(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    songs[<span class="st">"release_month"</span>].value_counts().index[<span class="dv">0</span>], inplace<span class="op">=</span><span class="va">True</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>songs[<span class="st">"release_day"</span>].fillna(songs[<span class="st">"release_day"</span>].value_counts().index[<span class="dv">0</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>songs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">track_popularity</th>
<th data-quarto-table-cell-role="th">playlist_genre</th>
<th data-quarto-table-cell-role="th">playlist_subgenre</th>
<th data-quarto-table-cell-role="th">danceability</th>
<th data-quarto-table-cell-role="th">energy</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">loudness</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">speechiness</th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">instrumentalness</th>
<th data-quarto-table-cell-role="th">liveness</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">tempo</th>
<th data-quarto-table-cell-role="th">duration_ms</th>
<th data-quarto-table-cell-role="th">release_year</th>
<th data-quarto-table-cell-role="th">release_month</th>
<th data-quarto-table-cell-role="th">release_day</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>66</td>
<td>pop</td>
<td>dance pop</td>
<td>0.748</td>
<td>0.916</td>
<td>6</td>
<td>-2.634</td>
<td>1</td>
<td>0.0583</td>
<td>0.102000</td>
<td>0.000000</td>
<td>0.0653</td>
<td>0.5180</td>
<td>122.036</td>
<td>194754</td>
<td>2019.0</td>
<td>6.0</td>
<td>14.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>67</td>
<td>pop</td>
<td>dance pop</td>
<td>0.726</td>
<td>0.815</td>
<td>11</td>
<td>-4.969</td>
<td>1</td>
<td>0.0373</td>
<td>0.072400</td>
<td>0.004210</td>
<td>0.3570</td>
<td>0.6930</td>
<td>99.972</td>
<td>162600</td>
<td>2019.0</td>
<td>12.0</td>
<td>13.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>70</td>
<td>pop</td>
<td>dance pop</td>
<td>0.675</td>
<td>0.931</td>
<td>1</td>
<td>-3.432</td>
<td>0</td>
<td>0.0742</td>
<td>0.079400</td>
<td>0.000023</td>
<td>0.1100</td>
<td>0.6130</td>
<td>124.008</td>
<td>176616</td>
<td>2019.0</td>
<td>7.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>60</td>
<td>pop</td>
<td>dance pop</td>
<td>0.718</td>
<td>0.930</td>
<td>7</td>
<td>-3.778</td>
<td>1</td>
<td>0.1020</td>
<td>0.028700</td>
<td>0.000009</td>
<td>0.2040</td>
<td>0.2770</td>
<td>121.956</td>
<td>169093</td>
<td>2019.0</td>
<td>7.0</td>
<td>19.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>69</td>
<td>pop</td>
<td>dance pop</td>
<td>0.650</td>
<td>0.833</td>
<td>1</td>
<td>-4.672</td>
<td>1</td>
<td>0.0359</td>
<td>0.080300</td>
<td>0.000000</td>
<td>0.0833</td>
<td>0.7250</td>
<td>123.976</td>
<td>189052</td>
<td>2019.0</td>
<td>3.0</td>
<td>5.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32828</td>
<td>42</td>
<td>edm</td>
<td>progressive electro house</td>
<td>0.428</td>
<td>0.922</td>
<td>2</td>
<td>-1.814</td>
<td>1</td>
<td>0.0936</td>
<td>0.076600</td>
<td>0.000000</td>
<td>0.0668</td>
<td>0.2100</td>
<td>128.170</td>
<td>204375</td>
<td>2014.0</td>
<td>4.0</td>
<td>28.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">32829</td>
<td>20</td>
<td>edm</td>
<td>progressive electro house</td>
<td>0.522</td>
<td>0.786</td>
<td>0</td>
<td>-4.462</td>
<td>1</td>
<td>0.0420</td>
<td>0.001710</td>
<td>0.004270</td>
<td>0.3750</td>
<td>0.4000</td>
<td>128.041</td>
<td>353120</td>
<td>2013.0</td>
<td>3.0</td>
<td>8.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32830</td>
<td>14</td>
<td>edm</td>
<td>progressive electro house</td>
<td>0.529</td>
<td>0.821</td>
<td>6</td>
<td>-4.899</td>
<td>0</td>
<td>0.0481</td>
<td>0.108000</td>
<td>0.000001</td>
<td>0.1500</td>
<td>0.4360</td>
<td>127.989</td>
<td>210112</td>
<td>2014.0</td>
<td>4.0</td>
<td>21.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">32831</td>
<td>15</td>
<td>edm</td>
<td>progressive electro house</td>
<td>0.626</td>
<td>0.888</td>
<td>2</td>
<td>-3.361</td>
<td>1</td>
<td>0.1090</td>
<td>0.007920</td>
<td>0.127000</td>
<td>0.3430</td>
<td>0.3080</td>
<td>128.008</td>
<td>367432</td>
<td>2014.0</td>
<td>1.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32832</td>
<td>27</td>
<td>edm</td>
<td>progressive electro house</td>
<td>0.603</td>
<td>0.884</td>
<td>5</td>
<td>-4.571</td>
<td>0</td>
<td>0.0385</td>
<td>0.000133</td>
<td>0.341000</td>
<td>0.7420</td>
<td>0.0894</td>
<td>127.984</td>
<td>337500</td>
<td>2014.0</td>
<td>3.0</td>
<td>3.0</td>
</tr>
</tbody>
</table>

<p>32833 rows × 18 columns</p>
</div>
</div>
</div>
<p>If we check once more, we see there are no missing values anymore</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>songs.isnull().values.<span class="bu">any</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>False</code></pre>
</div>
</div>
</section>
<section id="visualization" class="level2">
<h2 class="anchored" data-anchor-id="visualization">Visualization</h2>
<p>Let’s visualize the data and get a better understanding of the values ### Genre</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sns.countplot(songs, x<span class="op">=</span><span class="st">"playlist_subgenre"</span>, hue<span class="op">=</span><span class="st">"playlist_genre"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>(array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
        17, 18, 19, 20, 21, 22, 23]),
 [Text(0, 0, 'dance pop'),
  Text(1, 0, 'post-teen pop'),
  Text(2, 0, 'electropop'),
  Text(3, 0, 'indie poptimism'),
  Text(4, 0, 'hip hop'),
  Text(5, 0, 'southern hip hop'),
  Text(6, 0, 'gangster rap'),
  Text(7, 0, 'trap'),
  Text(8, 0, 'album rock'),
  Text(9, 0, 'classic rock'),
  Text(10, 0, 'permanent wave'),
  Text(11, 0, 'hard rock'),
  Text(12, 0, 'tropical'),
  Text(13, 0, 'latin pop'),
  Text(14, 0, 'reggaeton'),
  Text(15, 0, 'latin hip hop'),
  Text(16, 0, 'urban contemporary'),
  Text(17, 0, 'hip pop'),
  Text(18, 0, 'new jack swing'),
  Text(19, 0, 'neo soul'),
  Text(20, 0, 'electro house'),
  Text(21, 0, 'big room'),
  Text(22, 0, 'pop edm'),
  Text(23, 0, 'progressive electro house')])</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="regression_files/figure-html/cell-10-output-2.png" width="602" height="589"></p>
</div>
</div>
<p>From this we can see playlist_subgenre is full contained in playlist_genre hence we can remote the playlist_genre as the playlist_subgenre has more fine grained information</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>songs <span class="op">=</span> songs.drop(<span class="st">"playlist_genre"</span>, axis<span class="op">=</span><span class="st">"columns"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="one-hot-encoding" class="level2">
<h2 class="anchored" data-anchor-id="one-hot-encoding">One hot encoding</h2>
<p>Notice how we have a categorical feature (i.e., playlist_subgenre), we need to one-hot encode this column.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>playlist_subgenre <span class="op">=</span> pd.get_dummies(songs[<span class="st">"playlist_subgenre"</span>])</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>songs <span class="op">=</span> pd.concat([songs, playlist_subgenre], axis<span class="op">=</span><span class="st">"columns"</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>songs <span class="op">=</span> songs.drop(<span class="st">"playlist_subgenre"</span>, axis<span class="op">=</span><span class="st">"columns"</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>songs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">track_popularity</th>
<th data-quarto-table-cell-role="th">danceability</th>
<th data-quarto-table-cell-role="th">energy</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">loudness</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">speechiness</th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">instrumentalness</th>
<th data-quarto-table-cell-role="th">liveness</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">new jack swing</th>
<th data-quarto-table-cell-role="th">permanent wave</th>
<th data-quarto-table-cell-role="th">pop edm</th>
<th data-quarto-table-cell-role="th">post-teen pop</th>
<th data-quarto-table-cell-role="th">progressive electro house</th>
<th data-quarto-table-cell-role="th">reggaeton</th>
<th data-quarto-table-cell-role="th">southern hip hop</th>
<th data-quarto-table-cell-role="th">trap</th>
<th data-quarto-table-cell-role="th">tropical</th>
<th data-quarto-table-cell-role="th">urban contemporary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>66</td>
<td>0.748</td>
<td>0.916</td>
<td>6</td>
<td>-2.634</td>
<td>1</td>
<td>0.0583</td>
<td>0.102000</td>
<td>0.000000</td>
<td>0.0653</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>67</td>
<td>0.726</td>
<td>0.815</td>
<td>11</td>
<td>-4.969</td>
<td>1</td>
<td>0.0373</td>
<td>0.072400</td>
<td>0.004210</td>
<td>0.3570</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>70</td>
<td>0.675</td>
<td>0.931</td>
<td>1</td>
<td>-3.432</td>
<td>0</td>
<td>0.0742</td>
<td>0.079400</td>
<td>0.000023</td>
<td>0.1100</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>60</td>
<td>0.718</td>
<td>0.930</td>
<td>7</td>
<td>-3.778</td>
<td>1</td>
<td>0.1020</td>
<td>0.028700</td>
<td>0.000009</td>
<td>0.2040</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>69</td>
<td>0.650</td>
<td>0.833</td>
<td>1</td>
<td>-4.672</td>
<td>1</td>
<td>0.0359</td>
<td>0.080300</td>
<td>0.000000</td>
<td>0.0833</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32828</td>
<td>42</td>
<td>0.428</td>
<td>0.922</td>
<td>2</td>
<td>-1.814</td>
<td>1</td>
<td>0.0936</td>
<td>0.076600</td>
<td>0.000000</td>
<td>0.0668</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">32829</td>
<td>20</td>
<td>0.522</td>
<td>0.786</td>
<td>0</td>
<td>-4.462</td>
<td>1</td>
<td>0.0420</td>
<td>0.001710</td>
<td>0.004270</td>
<td>0.3750</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32830</td>
<td>14</td>
<td>0.529</td>
<td>0.821</td>
<td>6</td>
<td>-4.899</td>
<td>0</td>
<td>0.0481</td>
<td>0.108000</td>
<td>0.000001</td>
<td>0.1500</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">32831</td>
<td>15</td>
<td>0.626</td>
<td>0.888</td>
<td>2</td>
<td>-3.361</td>
<td>1</td>
<td>0.1090</td>
<td>0.007920</td>
<td>0.127000</td>
<td>0.3430</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32832</td>
<td>27</td>
<td>0.603</td>
<td>0.884</td>
<td>5</td>
<td>-4.571</td>
<td>0</td>
<td>0.0385</td>
<td>0.000133</td>
<td>0.341000</td>
<td>0.7420</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>32833 rows × 40 columns</p>
</div>
</div>
</div>
<section id="correlation" class="level3">
<h3 class="anchored" data-anchor-id="correlation">Correlation</h3>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>cor <span class="op">=</span> songs.corr()</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cor)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>cor <span class="op">=</span> cor.<span class="bu">abs</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="regression_files/figure-html/cell-13-output-1.png" width="704" height="576"></p>
</div>
</div>
<p>Let’s see the top 5 correclations</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cor_values <span class="op">=</span> (</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    cor.where(np.triu(np.ones(cor.shape), k<span class="op">=</span><span class="dv">1</span>).astype(<span class="bu">bool</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    .stack()</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    .sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>top_n <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Top 5 correlation values are"</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, v <span class="kw">in</span> cor_values[:top_n].items():</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="sc">{}</span><span class="st"> - </span><span class="sc">{}</span><span class="st"> "</span>.<span class="bu">format</span>(i, v))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Top 5 correlation values are
('energy', 'loudness') - 0.6766245234442312 
('energy', 'acousticness') - 0.5397446301909388 
('loudness', 'acousticness') - 0.36163816507093 
('danceability', 'valence') - 0.3305232570910807 
('release_month', 'release_day') - 0.3080926045288983 </code></pre>
</div>
</div>
<p>As expected ‘energy’, ‘loudness’ are correlated to a degree but none of these correlation values are significantly high enought to warrant removal befor the training so we keep all our features.</p>
</section>
</section>
<section id="target-and-data" class="level2">
<h2 class="anchored" data-anchor-id="target-and-data">Target and Data</h2>
<p>Let’s now split features into X and Y with the later being our target for prediction</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> songs[<span class="st">"track_popularity"</span>].to_numpy()</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> songs.drop(<span class="st">"track_popularity"</span>, axis<span class="op">=</span><span class="st">"columns"</span>).to_numpy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="normalization" class="level2">
<h2 class="anchored" data-anchor-id="normalization">Normalization</h2>
<p>Normalize the features to bring them all to 0-1 range</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>x_normalized <span class="op">=</span> preprocessing.normalize(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="training-and-test-split-and-data" class="level2">
<h2 class="anchored" data-anchor-id="training-and-test-split-and-data">Training and Test Split and Data</h2>
<p>Let’s split our data into training and test sets with 80 to 20 ratio.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x_normalized, y, test_size<span class="op">=</span><span class="fl">0.20</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training X Shape: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(x_train.shape))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Training Y Shape: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(y_train.shape))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Test X Shape: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(x_test.shape))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Test y Shape: </span><span class="sc">{}</span><span class="st">"</span>.<span class="bu">format</span>(y_test.shape))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Training X Shape: (26266, 39)
Training Y Shape: (26266,)
Test X Shape: (6567, 39)
Test y Shape: (6567,)</code></pre>
</div>
</div>
</section>
</section>
<section id="training-and-optimization" class="level1">
<h1>Training and Optimization</h1>
<section id="regression-models" class="level2">
<h2 class="anchored" data-anchor-id="regression-models">Regression models</h2>
<p>We will try to train on multiple algorithms and perform hyperparamter tuining on each to find the best performing model</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> {</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ExtraTreesRegressor"</span>: {</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"model"</span>: ExtraTreesRegressor(),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"params"</span>: {</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">"n_estimators"</span>: [<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>],</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">"max_depth"</span>: [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>],</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"min_samples_split"</span>: [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>],</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">"min_samples_leaf"</span>: [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"adaboost"</span>: {</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"model"</span>: AdaBoostRegressor(),</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"params"</span>: {</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">"n_estimators"</span>: [<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>],</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">"loss"</span>: [<span class="st">"linear"</span>, <span class="st">"square"</span>, <span class="st">"exponential"</span>],</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"svm"</span>: {</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"model"</span>: svm.SVR(),</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"params"</span>: {</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">"degree"</span>: [<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>],</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">"C"</span>: [<span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span>],</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"knr"</span>: {</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">"model"</span>: KNeighborsRegressor(),</span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">"params"</span>: {</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">"n_neighbors"</span>: [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">8</span>],</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">"weights"</span>: [<span class="st">"uniform"</span>, <span class="st">"distance"</span>],</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">"leaf_size"</span>: [<span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>],</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rnr"</span>: {</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">"model"</span>: RadiusNeighborsRegressor(),</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>        <span class="st">"params"</span>: {</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">"radius"</span>: [<span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span>],</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">"weights"</span>: [<span class="st">"uniform"</span>, <span class="st">"distance"</span>],</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">"leaf_size"</span>: [<span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>],</span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">"RandomForestRegressor"</span>: {</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>        <span class="st">"model"</span>: RandomForestRegressor(),</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">"params"</span>: {</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">"n_estimators"</span>: [<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>],</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>            <span class="st">"max_depth"</span>: [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>],</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>            <span class="st">"min_samples_split"</span>: [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>],</span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">"min_samples_leaf"</span>: [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">"boosting"</span>: {</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">"model"</span>: GradientBoostingRegressor(),</span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>        <span class="st">"params"</span>: {</span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>            <span class="st">"n_estimators"</span>: [<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>],</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>            <span class="st">"loss"</span>: [<span class="st">"linear"</span>, <span class="st">"square"</span>, <span class="st">"exponential"</span>],</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>            <span class="st">"min_samples_split"</span>: [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>],</span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s peform the training and hyperparamter tuining. Start by preparing a variable to store the best model and it’s param values in</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>best_model, best_params, best_performance <span class="op">=</span> <span class="va">None</span>, <span class="va">None</span>, <span class="bu">float</span>(<span class="st">"inf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Loop through each model and perform randomized search. <strong>Note</strong>: Running the following code takes a lot of time so what I did was run it on google colab and bring the results here.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, info <span class="kw">in</span> models.items():</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    random_search <span class="op">=</span> RandomizedSearchCV(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>        info[<span class="st">"model"</span>],</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>        info[<span class="st">"params"</span>],</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        scoring<span class="op">=</span><span class="st">"neg_mean_squared_error"</span>,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>        cv<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        n_jobs<span class="op">=-</span><span class="dv">1</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    random_search.fit(x_train, y_train)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the best model and its parameters</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    winning_model <span class="op">=</span> random_search.best_estimator_</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    winning_model_params <span class="op">=</span> random_search.best_params_</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check the performance of the best model using the test data.</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We need to round the predicted values because the target feature is integer</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    y_pred <span class="op">=</span> np.<span class="bu">round</span>(winning_model.predict(x_test))</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    error <span class="op">=</span> mean_squared_error(y_test, y_pred)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the best_model_info if the current model has lower MSE</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> error <span class="op">&lt;</span> best_performance:</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>        best_performance <span class="op">=</span> error</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>        best_model <span class="op">=</span> winning_model</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>        best_params <span class="op">=</span> winning_model_params</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the best model information</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Best Model: </span><span class="sc">{</span>best_model<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Best Parameters: </span><span class="sc">{</span>best_params<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>I found the best berformance in terms of mean absolut error comes from AdaBoostRegressor with the follwoing details</p>
<section id="best-model" class="level3">
<h3 class="anchored" data-anchor-id="best-model">Best Model</h3>
<p>Best Model: AdaBoostRegressor(n_estimators=75)</p>
<p>Best Parameters: {‘n_estimators’: 75, ‘loss’: ‘linear’}</p>
<p>Lowest Mean Squared Error: 591.7667123496269</p>
</section>
<section id="other-sample-runs-are-as-follows" class="level2">
<h2 class="anchored" data-anchor-id="other-sample-runs-are-as-follows">Other sample runs are as follows</h2>
<section id="kneighborsregressor" class="level3">
<h3 class="anchored" data-anchor-id="kneighborsregressor">KNeighborsRegressor</h3>
<ul>
<li>Model: KNeighborsRegressor(leaf_size=20, n_neighbors=8)</li>
<li>Parameters: {‘n_neighbors’: 8, ‘leaf_size’: 20}</li>
<li>Mean Squared Error: 619.6920968478757</li>
</ul>
</section>
<section id="radiusneighborsregressor" class="level3">
<h3 class="anchored" data-anchor-id="radiusneighborsregressor">RadiusNeighborsRegressor</h3>
<ul>
<li>Model: RadiusNeighborsRegressor(leaf_size=40, radius=0.5, weights=‘distance’)</li>
<li>Parameters: {‘weights’: ‘distance’, ‘radius’: 0.5, ‘leaf_size’: 40}</li>
<li>Mean Squared Error: 615.0418760469012</li>
</ul>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>